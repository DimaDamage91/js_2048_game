const t=new class{constructor(t){if(this.currentCount=0,this.firstMoveMade=!1,t)this.state=t;else{this.state=[];for(let t=0;t<4;t++){let t=[];for(let e=0;e<4;e++)t.push(0);this.state.push(t)}}this.score=0}calculateScore(){this.score=0;for(let t=0;t<this.state.length;t++)for(let e=0;e<this.state[t].length;e++)2!==this.state[t][e]&&(this.score+=this.state[t][e])}canMerge(){for(let t=0;t<this.state.length;t++)for(let e=0;e<this.state[t].length;e++)if(0!==this.state[t][e]&&(e>0&&(this.state[t][e-1]===this.state[t][e]||0===this.state[t][e-1])||e<3&&(this.state[t][e+1]===this.state[t][e]||0===this.state[t][e+1])||t>0&&(this.state[t-1][e]===this.state[t][e]||0===this.state[t-1][e])||t<3&&(this.state[t+1][e]===this.state[t][e]||0===this.state[t+1][e])))return!0;return!1}generateNewTile(){let t=[];for(let e=0;e<this.state.length;e++)for(let s=0;s<this.state[e].length;s++)0===this.state[e][s]&&t.push({i:e,j:s});if(t.length>0){let e=t[Math.floor(Math.random()*t.length)];this.state[e.i][e.j]=.1>Math.random()?4:2}}updateGameField(){document.querySelectorAll(".field-cell").forEach((t,e)=>{let s=Math.floor(e/4),r=this.getState()[s][e%4];t.textContent=0!==r?r:"",t.className="field-cell",r&&t.classList.add(`field-cell--${r}`)});let t=this.getStatus();"Win"===t?document.querySelector(".message-win").classList.remove("hidden"):"Loose"===t&&document.querySelector(".message-lose").classList.remove("hidden"),this.calculateScore(),document.querySelector(".game-score").textContent=this.score}addEventListeners(){document.addEventListener("keydown",t=>{if(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(t.key)){switch(t.key){case"ArrowLeft":this.moveLeft();break;case"ArrowRight":this.moveRight();break;case"ArrowUp":this.moveUp();break;case"ArrowDown":this.moveDown()}this.updateGameField()}}),document.querySelector(".start").addEventListener("click",()=>{this.start(),this.generateNewTile(),this.generateNewTile(),this.updateGameField(),document.querySelector(".message-start").classList.add("hidden")})}moveLeft(){let t=JSON.stringify(this.state),e=[];for(let t=0;t<this.state.length;t++){let s=this.state[t],r=s.filter(t=>0!==t);for(let t=0;t<r.length-1;t++)r[t]===r[t+1]&&(r[t]*=2,r.splice(t+1,1),this.currentCount+=r[t]);for(;r.length<s.length;)r.push(0);e.push(r)}this.state=e,t!==JSON.stringify(this.state)&&this.generateNewTile(),this.firstMoveMade||(document.querySelector(".message-start").classList.add("hidden"),this.firstMoveMade=!0,document.querySelector(".start").textContent="Restart",document.querySelector(".start").style.background="red"),this.updateGameField()}moveRight(){let t=JSON.stringify(this.state),e=[];for(let t=0;t<this.state.length;t++){let s=[...this.state[t]].reverse(),r=s.filter(t=>0!==t);for(let t=0;t<r.length-1;t++)r[t]===r[t+1]&&(r[t]*=2,r.splice(t+1,1),this.currentCount+=r[t]);for(;r.length<s.length;)r.push(0);e.push(r.reverse())}this.state=e,t!==JSON.stringify(this.state)&&this.generateNewTile(),this.firstMoveMade||(document.querySelector(".message-start").classList.add("hidden"),this.firstMoveMade=!0,document.querySelector(".start").textContent="Restart",document.querySelector(".start").style.background="red"),this.updateGameField()}moveUp(){let t=JSON.stringify(this.state);for(let t=0;t<this.state.length;t++){let e=[];for(let s=0;s<this.state.length;s++)0!==this.state[s][t]&&e.push(this.state[s][t]);for(let t=0;t<e.length;t++)e[t]===e[t+1]&&(e[t]*=2,e.splice(t+1,1),this.currentCount+=e[t]);for(;e.length<this.state.length;)e.push(0);for(let s=0;s<this.state.length;s++)this.state[s][t]=e[s]}t!==JSON.stringify(this.state)&&this.generateNewTile(),this.firstMoveMade||(document.querySelector(".message-start").classList.add("hidden"),this.firstMoveMade=!0,document.querySelector(".start").textContent="Restart",document.querySelector(".start").style.background="red"),this.updateGameField()}moveDown(){let t=JSON.stringify(this.state);for(let t=0;t<this.state.length;t++){let e=[];for(let s=this.state.length-1;s>=0;s--)0!==this.state[s][t]&&e.push(this.state[s][t]);for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&(e[t]*=2,e.splice(t+1,1),this.currentCount+=e[t]);for(;e.length<this.state.length;)e.push(0);for(let s=0;s<this.state.length;s++)this.state[this.state.length-1-s][t]=e[s]}t!==JSON.stringify(this.state)&&this.generateNewTile(),this.firstMoveMade||(document.querySelector(".message-start").classList.add("hidden"),this.firstMoveMade=!0,document.querySelector(".start").textContent="Restart",document.querySelector(".start").style.background="red"),this.updateGameField()}getScore(){return this.currentCount}getState(){return this.state}getStatus(){let t=!1;for(let e=0;e<this.state.length;e++)for(let s=0;s<this.state[e].length;s++){if(2048===this.state[e][s])return"Win";0===this.state[e][s]&&(t=!0)}return t||this.canMerge()?"The game continuous":"Loose"}start(){this.currentCount=0,this.firstMoveMade=!1,this.state=Array.from({length:4},()=>[,,,,].fill(0)),this.updateGameField(),document.querySelector(".message-lose").classList.add("hidden"),document.querySelector(".message-win").classList.add("hidden"),document.querySelector(".start").textContent="Start",document.querySelector(".start").style.background="green"}restart(){this.start(),document.querySelector(".message-start").classList.remove("hidden"),document.querySelector(".start").textContent="Start"}};t.addEventListeners(),t.start();
//# sourceMappingURL=index.7b2d041d.js.map
